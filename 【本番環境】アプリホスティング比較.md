# 🚀 本番環境向け - アプリホスティング比較

## 📋 前提条件

- ✅ **完全無料（must be free）**
- ✅ **本番環境（public deploy）前提**
- ✅ **フルスタックアプリ**（React + Express + tRPC）
- ✅ **PlanetScale**（データベース）と連携

---

## 🏆 推奨: Render ⭐

### なぜ Render か？

1. ✅ **無料プランあり**
   - Webサービス: 無料（スリープする）
   - データベース: 無料プランあり

2. ✅ **フルスタック対応**
   - Express + Reactのフルスタックアプリに対応
   - 静的ファイル配信も可能

3. ✅ **簡単なデプロイ**
   - GitHub連携で自動デプロイ
   - 環境変数の設定が簡単

4. ✅ **本番環境対応**
   - HTTPS自動対応
   - カスタムドメイン可能

### 無料プランの制限

- **Webサービス**:
  - スリープ（15分非アクセス後）
  - 起動時間がかかる（約30秒）
  - 512MB RAM

- **制限**:
  - 帯域幅: 100GB/月
  - 起動が遅い（スリープ後の初回アクセス）

**小規模アプリには十分** ✅

---

## 📊 比較表

| 項目 | Render | Railway | Fly.io | Vercel |
|------|--------|---------|--------|--------|
| 無料プラン | ✅ あり | ⚠️ クレジット制限 | ✅ あり | ✅ あり |
| フルスタック | ✅ 対応 | ✅ 対応 | ✅ 対応 | ⚠️ サーバーレス |
| スリープ | ✅ あり | ❌ なし | ❌ なし | ❌ なし |
| セットアップ | ✅ 簡単 | ✅ 簡単 | ⚠️ やや複雑 | ⚠️ 構成変更必要 |
| 本番環境 | ✅ OK | ✅ OK | ✅ OK | ⚠️ 構成変更必要 |

---

## 🔄 アーキテクチャ

```
┌─────────────────────────────────────┐
│  ユーザー（ブラウザ）                │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│  Render（アプリホスティング）        │
│  - React フロントエンド              │
│  - Express バックエンド              │
│  - tRPC API                         │
└──────────────┬──────────────────────┘
               │
               ▼
┌─────────────────────────────────────┐
│  PlanetScale（データベース）         │
│  - MySQL互換                         │
│  - 完全無料                          │
└─────────────────────────────────────┘
```

---

## 📥 Render セットアップ手順

### ステップ1: Renderアカウント作成

1. **Renderにアクセス**
   - https://render.com/
   - 「Get Started for Free」をクリック

2. **アカウント作成**
   - GitHubアカウントでログイン（推奨）
   - または、メールアドレスで登録

### ステップ2: 新しいWebサービスを作成

1. **「New +」→「Web Service」を選択**

2. **GitHubリポジトリを連携**
   - GitHubリポジトリを選択
   - または、リポジトリを接続

3. **サービス設定**
   - **Name**: `space-mood-oracle`
   - **Region**: 日本に近いものを選択（例: `Oregon (US West)`）
   - **Branch**: `main`（またはデフォルトブランチ）
   - **Root Directory**: `space_mood_oracle_v2.1/space_mood_oracle`（プロジェクトルートを指定）
   - **Runtime**: `Node`
   - **Build Command**: `pnpm install && pnpm build`
   - **Start Command**: `pnpm start`
   - **Instance Type**: `Free`

4. **環境変数を設定**
   - 「Environment」セクションを開く
   - 以下の環境変数を追加:

   ```
   DATABASE_URL=mysql://username:password@host.planetscale.com:3306/database?sslaccept=strict
   JWT_SECRET=your-random-secret-key-change-this-in-production
   NODE_ENV=production
   PORT=10000
   ```

   **注意**: `DATABASE_URL` はPlanetScaleから取得した接続文字列を使用

5. **「Create Web Service」をクリック**

### ステップ3: デプロイ開始

- Renderが自動的にビルドとデプロイを開始
- 初回は約5-10分かかります
- デプロイが完了すると、URLが表示されます

### ステップ4: 確認

- デプロイが成功したら、URLにアクセス
- アプリが正常に動作するか確認 ✅

---

## ⚠️ 無料プランの注意点

### スリープについて

- **15分間アクセスがないとスリープ**
- **初回アクセス時に約30秒かかる**（起動時間）

### スリープを回避する方法

1. **Pingサービスを使う**（推奨）
   - UptimeRobot（無料）で定期Ping
   - https://uptimerobot.com/

2. **有料プランにアップグレード**
   - $7/月でスリープなし

**小規模アプリなら無料プランで十分** ✅

---

## 🔄 代替案

### オプション1: Railway

**特徴:**
- 月$5分のクレジット
- スリープなし
- フルスタック対応

**注意:**
- クレジット制限あり
- 使用量に応じて課金

### オプション2: Fly.io

**特徴:**
- 無料枠あり
- スリープなし（3アプリまで）
- グローバル展開

**注意:**
- セットアップがやや複雑
- 制限あり

### オプション3: Vercel

**特徴:**
- 無料プランあり
- スリープなし
- 高速デプロイ

**注意:**
- サーバーレス構成（ExpressをServerless Functionsに変換が必要）
- 構成変更が必要

---

## 💡 推奨の理由

### Render が最適な理由

1. ✅ **完全無料**（スリープありだが使用可能）
2. ✅ **フルスタック対応**（コード変更不要）
3. ✅ **セットアップが簡単**（GitHub連携）
4. ✅ **本番環境対応**（HTTPS自動）
5. ✅ **PlanetScaleとの連携が簡単**

### 構成の利点

- **データベース**: PlanetScale（完全無料、高性能）
- **アプリ**: Render（完全無料、簡単セットアップ）
- **合計コスト**: **$0/月** ✅

---

## 📝 まとめ

### 推奨構成

- **データベース**: **PlanetScale**（完全無料）
- **アプリホスティング**: **Render**（完全無料）

### セットアップ時間

- PlanetScale: 約5分
- Render: 約10分
- **合計: 約15分** ⏱️

### 次のステップ

1. ✅ PlanetScaleでデータベース作成
2. ✅ Renderでアプリをデプロイ
3. ✅ 環境変数を設定
4. ✅ 動作確認

---

**Renderでアプリをデプロイしましょう！** 🚀

詳細: https://render.com/

