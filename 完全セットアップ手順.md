# 🚀 完全セットアップ手順（データベース作成から動作確認まで）

## 📋 前提条件

- MySQL/MariaDBがインストールされている
- データベースサーバーが起動している
- データベースへの接続権限がある

---

## 🎯 全手順（4ステップ）

### ステップ1: データベースを作成 ⭐

#### 最も簡単な方法

1. **SQLファイルを開く**: `データベース作成SQL.sql`
2. **SQLをコピー**
3. **データベース管理ツールで実行**:
   - phpMyAdmin: SQLタブ → ペースト → 実行
   - MySQL Workbench: クエリエディタ → ペースト → 実行

**または、直接SQLを実行:**

```sql
CREATE DATABASE IF NOT EXISTS space_mood_oracle 
  CHARACTER SET utf8mb4 
  COLLATE utf8mb4_general_ci;
```

**確認:**
```sql
SHOW DATABASES;
```
→ `space_mood_oracle` が表示されればOK ✅

---

### ステップ2: テーブルを作成（マイグレーション） ⭐

1. **SQLファイルを開く**: `マイグレーション実行SQL.sql`
2. **SQLをコピー**（3つのCREATE TABLE文）
3. **データベースを選択してから実行**:
   - phpMyAdmin: 左側で `space_mood_oracle` を選択 → SQLタブ → ペースト → 実行
   - MySQL Workbench: `USE space_mood_oracle;` を追加してから実行

**または、コマンドライン:**

```bash
mysql -u ユーザー名 -p space_mood_oracle < マイグレーション実行SQL.sql
```

**確認:**
```sql
USE space_mood_oracle;
SHOW TABLES;
```
→ 3つのテーブル名が表示されればOK ✅

---

### ステップ3: 環境変数を設定

プロジェクトルートに `.env` ファイルを作成:

```env
# データベース接続情報
DATABASE_URL=mysql://ユーザー名:パスワード@localhost:3306/space_mood_oracle

# 例:
# DATABASE_URL=mysql://root:password@localhost:3306/space_mood_oracle
```

**注意**: ユーザー名、パスワード、ホスト、ポートを実際の値に置き換えてください。

---

### ステップ4: 動作確認

#### サーバー起動

```bash
pnpm dev
```

`http://localhost:3000` で起動することを確認 ✅

#### APIテスト

ブラウザの開発者ツール（F12）のConsoleで:

```javascript
fetch('/api/trpc/trends.getTodayMood')
  .then(r => r.json())
  .then(data => {
    console.log('✅ 成功！', data);
  })
  .catch(err => {
    console.error('❌ エラー', err);
  });
```

**期待される結果:**
```json
{
  "result": {
    "data": {
      "success": true,
      "judgment": {
        "judgment": "good",
        ...
      }
    }
  }
}
```

→ この結果が返ってくれば完了！🎉

---

## 📁 実行するSQLファイル

1. **`データベース作成SQL.sql`** - ステップ1で実行
2. **`マイグレーション実行SQL.sql`** - ステップ2で実行

---

## ✅ チェックリスト

### 実行前
- [ ] MySQL/MariaDBがインストールされている
- [ ] データベースサーバーが起動している
- [ ] 接続情報（ユーザー名、パスワード）が分かっている

### 実行後
- [ ] データベース `space_mood_oracle` が作成された
- [ ] 3つのテーブルが作成された
- [ ] `.env` ファイルに `DATABASE_URL` が設定された
- [ ] サーバーが起動した
- [ ] APIが正常に動作した

---

## 🆘 トラブルシューティング

### "Access denied"

→ データベースへのアクセス権限がない  
→ 管理者権限でログインするか、ユーザーに権限を付与

### "Unknown database"

→ データベースが作成されていない  
→ ステップ1を実行

### "Table doesn't exist"

→ マイグレーションが未実行  
→ ステップ2を実行

### "Cannot connect to database"

→ `DATABASE_URL` が正しく設定されていない  
→ `.env` ファイルを確認

---

## 📚 詳細ドキュメント

- **データベース作成詳細**: `データベース作成手順.md`
- **マイグレーション詳細**: `README_マイグレーション.md`
- **動作確認詳細**: `動作確認手順.md`

---

## 🎉 完了予定時間

- データベース作成: **2分**
- テーブル作成: **3分**
- 環境変数設定: **1分**
- 動作確認: **5分**

**合計: 約11分で完了！**

---

**それでは、ステップ1から始めましょう！** 🚀

