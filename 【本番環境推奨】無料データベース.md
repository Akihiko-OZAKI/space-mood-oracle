# 🚀 本番環境推奨 - 無料データベース

## 📋 前提条件

- ✅ **本番環境（public deploy）前提**
- ✅ **完全無料（must be free）**
- ✅ **MySQL互換**（既存コード変更不要）

---

## 🏆 推奨: PlanetScale ⭐

### なぜ PlanetScale か？

1. ✅ **完全無料プランあり**（Hobbyプラン）
   - 期限なし
   - 本番環境でも使用可能

2. ✅ **MySQL互換**
   - コード変更不要
   - 既存のスキーマがそのまま使える

3. ✅ **本番環境対応**
   - 自動スケーリング
   - 高パフォーマンス
   - 自動バックアップ

4. ✅ **使いやすい**
   - セットアップが簡単
   - ダッシュボードが分かりやすい

### 無料枠（Hobbyプラン）

- **ストレージ**: 5GB
- **リクエスト**: 10億行/月
- **データベース**: 1つ
- **期限**: **なし（完全無料）**

### 制限事項

- 5GBのストレージ制限（小規模アプリには十分）
- 10億リクエスト/月の制限

---

## 📥 PlanetScale セットアップ手順

### ステップ1: アカウント作成

1. **PlanetScaleにアクセス**
   - https://planetscale.com/
   - 「Sign up」でアカウント作成
   - GitHubアカウントでログイン可能

2. **プラン選択**
   - 「Hobby」（無料）を選択

### ステップ2: データベース作成

1. **「Create database」をクリック**
2. **データベース名を入力**: `space_mood_oracle`
3. **リージョン選択**: 日本に近いものを選択
4. **「Create database」をクリック**

### ステップ3: 接続情報を取得

1. 作成したデータベースを開く
2. 上部の「Connect」ボタンをクリック
3. 「Connect with」から「General」または「Prisma」を選択
4. **接続文字列をコピー**

**接続文字列の形式:**
```
mysql://username:password@host.planetscale.com:3306/database
```

### ステップ4: 環境変数を設定

プロジェクトルートに `.env` ファイルを作成:

```env
DATABASE_URL=mysql://username:password@host.planetscale.com:3306/database

JWT_SECRET=your-random-secret-key-change-this
```

**注意**: `username`, `password`, `host`, `database` を実際の値に置き換えてください。

### ステップ5: データベース作成（マイグレーション）

PlanetScaleのダッシュボードからSQLを実行:

1. データベースを開く
2. 「Branches」タブを開く
3. 「main」ブランチを選択（または開発ブランチを作成）
4. 「Console」タブを開く
5. `【今すぐ実行】DB作成.sql` のSQLをコピー＆ペースト
6. 「Run」をクリック

**または、コマンドラインから:**

```bash
# PlanetScale CLIをインストール（オプション）
# または、接続文字列を使って直接接続

mysql -h host.planetscale.com -u username -p database < 【今すぐ実行】DB作成.sql
```

---

## 🔄 代替案（PlanetScaleが使えない場合）

### オプション1: TiDB Cloud

- MySQL互換
- 無料枠あり
- 引継ぎサマリーで推奨

**セットアップ:**
1. https://tidbcloud.com/ にアカウント作成
2. 無料クラスターを作成
3. 接続情報を取得

### オプション2: AWS RDS（無料枠）

- 12ヶ月間無料
- MySQL対応
- その後有料

**注意**: 12ヶ月後は有料になる

### オプション3: Railway

- 月$5分のクレジット
- MySQL対応
- データベース + アプリホスティング

**注意**: クレジット制限あり

---

## 💡 推奨の理由

### PlanetScale が最適な理由

1. ✅ **完全無料**（期限なし）
2. ✅ **本番環境で使用可能**
3. ✅ **MySQL互換**（コード変更不要）
4. ✅ **高パフォーマンス**
5. ✅ **自動スケーリング**
6. ✅ **セットアップが簡単**

### 他の選択肢との比較

| 項目 | PlanetScale | TiDB Cloud | AWS RDS |
|------|-------------|------------|---------|
| 完全無料 | ✅ 期限なし | ✅ 無料枠あり | ⚠️ 12ヶ月のみ |
| 本番環境 | ✅ OK | ✅ OK | ✅ OK |
| MySQL互換 | ✅ | ✅ | ✅ |
| セットアップ | ✅ 簡単 | ✅ 簡単 | ⚠️ やや複雑 |

---

## 📝 セットアップ完了後の流れ

1. ✅ PlanetScaleでデータベース作成
2. ✅ 接続情報を `.env` に設定
3. ✅ マイグレーションSQLを実行
4. ✅ サーバー起動（`pnpm dev`）
5. ✅ APIテスト

---

## 🎯 まとめ

**推奨: PlanetScale（無料プラン）**

- 完全無料（期限なし）
- 本番環境で使用可能
- MySQL互換（コード変更不要）
- セットアップが簡単

**セットアップ時間: 約10分** ⏱️

---

**PlanetScaleのセットアップを始めますか？** 🚀


