# 🚀 本番環境向け - 無料データベース比較

## 📋 前提条件

- ✅ **本番環境（public deploy）を前提**
- ✅ **完全無料（must be free）**
- ✅ **MySQL互換**（既存コードがMySQL用）

---

## 🎯 推奨順位

### 1. PlanetScale ⭐ 最推奨

**特徴:**
- MySQL互換
- **完全無料プランあり**（Hobbyプラン）
- 本番環境でも使用可能
- スケーラブル
- ブランチ機能（開発環境と本番環境の分離）

**無料枠:**
- 5GBストレージ
- 10億行リクエスト/月
- 1データベース
- **期限なし（完全無料）**

**メリット:**
- ✅ 完全無料で本番環境に使用可能
- ✅ MySQL互換（コード変更不要）
- ✅ 高パフォーマンス
- ✅ 自動バックアップ
- ✅ サーバーレス（スケール自動調整）

**デメリット:**
- ❌ ストレージ制限（5GB）
- ❌ 10億リクエスト/月の制限

**セットアップ:**
1. https://planetscale.com/ にアカウント作成
2. 無料プラン（Hobby）を選択
3. データベースを作成
4. 接続文字列を取得
5. `.env` ファイルに設定

**接続文字列形式:**
```
DATABASE_URL=mysql://username:password@host.planetscale.com:3306/database
```

---

### 2. TiDB Cloud（引継ぎサマリーで推奨）

**特徴:**
- MySQL互換
- 無料枠あり
- 分散データベース

**無料枠:**
- Developer Tier（無料）
- 制限あり（詳細要確認）

**メリット:**
- ✅ MySQL互換
- ✅ 引継ぎサマリーで推奨

**デメリット:**
- ⚠️ 無料枠の詳細制限要確認

**セットアップ:**
1. https://tidbcloud.com/ にアカウント作成
2. 無料クラスターを作成
3. 接続情報を取得
4. `.env` ファイルに設定

---

### 3. Railway

**特徴:**
- データベース + アプリホスティング
- 無料クレジットあり
- MySQL対応

**無料枠:**
- 月$5分のクレジット
- 使用量に応じて

**メリット:**
- ✅ データベース + アプリを同じプラットフォームで管理
- ✅ デプロイが簡単

**デメリット:**
- ⚠️ クレジット制限あり
- ⚠️ 完全無料ではない可能性

---

### 4. Supabase

**特徴:**
- PostgreSQL（MySQLではない）
- 完全無料プランあり

**注意:**
- ❌ PostgreSQLなので、コード変更が必要
- ❌ スキーマの変更が必要

---

## 💡 推奨: PlanetScale

### 理由

1. ✅ **完全無料で本番環境に使用可能**
2. ✅ **MySQL互換**（コード変更不要）
3. ✅ **期限なし**
4. ✅ **高パフォーマンス**
5. ✅ **自動スケーリング**

---

## 📥 PlanetScaleセットアップ手順

### ステップ1: アカウント作成

1. https://planetscale.com/ にアクセス
2. 「Sign up」でアカウント作成
3. 無料プラン（Hobby）を選択

### ステップ2: データベース作成

1. 「Create database」をクリック
2. データベース名を入力: `space_mood_oracle`
3. リージョン選択（日本に近いものを推奨）
4. 「Create」をクリック

### ステップ3: 接続情報を取得

1. データベースを開く
2. 「Connect」タブをクリック
3. 「Connect with」→ 「Prisma」または「General」を選択
4. 接続文字列をコピー

**例:**
```
mysql://username:password@host.planetscale.com:3306/database
```

### ステップ4: 環境変数を設定

`.env` ファイルを作成:

```env
DATABASE_URL=mysql://username:password@host.planetscale.com:3306/database

JWT_SECRET=your-random-secret-key
```

### ステップ5: マイグレーション実行

PlanetScaleはブランチ機能があるため、開発ブランチで実行:

```bash
# 開発ブランチを作成（PlanetScaleのダッシュボードから）
# その後、マイグレーションSQLを実行
```

または、PlanetScaleのダッシュボードから直接SQLを実行:

1. データベースを開く
2. 「Branches」タブを開く
3. 「main」ブランチを選択
4. 「Console」タブを開く
5. `【今すぐ実行】DB作成.sql` のSQLを実行

---

## 🔄 データベース変更の影響

### PlanetScaleの場合

- ✅ **コード変更不要**（MySQL互換）
- ✅ **接続文字列だけ変更**

### その他の場合

- PlanetScale以外でも、MySQL互換ならコード変更不要

---

## 📊 比較表

| 項目 | PlanetScale | TiDB Cloud | Railway |
|------|-------------|------------|---------|
| 無料枠 | ✅ 完全無料（期限なし） | ✅ 無料枠あり | ⚠️ クレジット制限 |
| MySQL互換 | ✅ | ✅ | ✅ |
| 本番環境 | ✅ OK | ✅ OK | ✅ OK |
| ストレージ | 5GB | 要確認 | クレジット内 |
| コード変更 | 不要 | 不要 | 不要 |

---

## 🎯 最終推奨

**PlanetScale（無料プラン）** を推奨

理由:
1. ✅ 完全無料で本番環境に使用可能
2. ✅ MySQL互換（コード変更不要）
3. ✅ 期限なし
4. ✅ セットアップが簡単

---

## 📝 次のステップ

1. ✅ PlanetScaleにアカウント作成
2. ✅ データベース作成
3. ✅ 接続情報を取得
4. ✅ `.env` ファイルに設定
5. ✅ マイグレーションSQLを実行
6. ✅ 動作確認

---

**PlanetScaleのセットアップを始めますか？** 🚀


